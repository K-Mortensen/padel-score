<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Padel Score</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle light/dark mode">‚òÄÔ∏è</button>

    <h1>PADEL SCORE</h1>
    <p class="subtitle">Track ¬∑ Play ¬∑ Win</p>

    <div class="sync-bar">
        <div class="sync-info">
            <div class="sync-dot" id="syncDot"></div>
            <div class="sync-text">
                <div class="sync-label">Shared Scoreboard</div>
                <div class="sync-sub" id="syncSub">Connecting‚Ä¶</div>
            </div>
        </div>
        <button class="sync-btn" id="syncRefreshBtn" onclick="loadFromServer()">‚Üª Refresh</button>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('play')">‚ö° Play</button>
        <button class="tab-btn" onclick="switchTab('history')">üìä Stats</button>
        <button class="tab-btn" onclick="switchTab('elo')">üèÜ Elo</button>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLAY TAB ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="tab-content active" id="tab-play">
        <div class="input-section">
            <div class="input-row">
                <span class="player-num">1</span>
                <input type="text" id="p1" placeholder="Player one" oninput="onPlayerInput()" />
                <span class="input-elo-badge provisional" id="elo-p1">‚Äî</span>
            </div>
            <div class="input-row">
                <span class="player-num">2</span>
                <input type="text" id="p2" placeholder="Player two" oninput="onPlayerInput()" />
                <span class="input-elo-badge provisional" id="elo-p2">‚Äî</span>
            </div>
            <div class="input-row">
                <span class="player-num">3</span>
                <input type="text" id="p3" placeholder="Player three" oninput="onPlayerInput()" />
                <span class="input-elo-badge provisional" id="elo-p3">‚Äî</span>
            </div>
            <div class="input-row">
                <span class="player-num">4</span>
                <input type="text" id="p4" placeholder="Player four" oninput="onPlayerInput()" />
                <span class="input-elo-badge provisional" id="elo-p4">‚Äî</span>
            </div>
            <p class="error" id="error"></p>
        </div>

        <div class="team-mode-row">
            <button class="mode-btn active" id="modeRandom" onclick="setMode('random')">üîÄ Random Teams</button>
            <button class="mode-btn" id="modeManual" onclick="setMode('manual')">‚úèÔ∏è Pick Teams</button>
        </div>

        <div class="manual-teams" id="manualTeams">
            <div class="manual-team-box">
                <div class="manual-team-label">‚ö° Team A ‚Äî Pick 2 Players</div>
                <div class="manual-team-picks" id="picksA"></div>
                <div class="manual-team-slots" id="slotsA">
                    <span style="font-size:0.75rem;color:var(--text-faint);letter-spacing:0.1em;">‚Äî no players selected ‚Äî</span>
                </div>
            </div>
            <div class="manual-team-box">
                <div class="manual-team-label" style="color:#7ab3e0;">üåä Team B ‚Äî Pick 2 Players</div>
                <div class="manual-team-picks" id="picksB"></div>
                <div class="manual-team-slots" id="slotsB">
                    <span style="font-size:0.75rem;color:var(--text-faint);letter-spacing:0.1em;">‚Äî no players selected ‚Äî</span>
                </div>
            </div>
        </div>

        <button class="btn" id="generateBtn" onclick="generateTeams()">Generate Teams</button>

        <div class="court-wrapper" id="courtWrapper">
            <p class="match-title">‚ö° Today's Match</p>
            <div class="court">
                <div class="court-lines">
                    <div class="line-v"></div>
                    <div class="line-h-left"></div>
                    <div class="line-h-right"></div>
                </div>
                <div class="court-elo-matchup" id="courtEloMatchup">ELO ‚Äî</div>
                <div class="side side-left">
                    <div class="player-card">
                        <div class="player-name" id="a1">‚Äî</div>
                        <div class="player-elo" id="a1elo">‚Äî</div>
                        <div class="player-label">Player</div>
                    </div>
                    <div class="player-card">
                        <div class="player-name" id="a2">‚Äî</div>
                        <div class="player-elo" id="a2elo">‚Äî</div>
                        <div class="player-label">Player</div>
                    </div>
                    <span class="team-label">TEAM A</span>
                    <div class="team-elo-bar">
                        <span>TEAM ELO</span>
                        <span class="team-elo-value" id="teamAElo">‚Äî</span>
                    </div>
                </div>
                <div class="net">
                    <div class="net-post-top"></div>
                    <div class="net-mesh"></div>
                    <div class="net-post-bottom"></div>
                </div>
                <div class="side side-right">
                    <div class="player-card">
                        <div class="player-name" id="b1">‚Äî</div>
                        <div class="player-elo" id="b1elo">‚Äî</div>
                        <div class="player-label">Player</div>
                    </div>
                    <div class="player-card">
                        <div class="player-name" id="b2">‚Äî</div>
                        <div class="player-elo" id="b2elo">‚Äî</div>
                        <div class="player-label">Player</div>
                    </div>
                    <span class="team-label">TEAM B</span>
                    <div class="team-elo-bar">
                        <span>TEAM ELO</span>
                        <span class="team-elo-value" id="teamBElo">‚Äî</span>
                    </div>
                </div>
            </div>

            <p class="vs-badge">TEAM A &nbsp;VS&nbsp; TEAM B</p>
            <button class="regenerate" id="shuffleBtn" onclick="shuffle()">üîÄ Shuffle Teams</button>

            <div class="score-section">
                <h3>üèÜ Save Match Result</h3>
                <div class="score-inputs">
                    <div class="score-team">
                        <div class="score-team-name" id="scoreTeamA">TEAM A</div>
                        <input class="score-input" type="number" id="scoreA" min="0" max="99" placeholder="0" oninput="updateEloPreview()" />
                    </div>
                    <div class="score-vs">VS</div>
                    <div class="score-team">
                        <div class="score-team-name" id="scoreTeamB">TEAM B</div>
                        <input class="score-input" type="number" id="scoreB" min="0" max="99" placeholder="0" oninput="updateEloPreview()" />
                    </div>
                </div>
                <div class="elo-preview">
                    <div class="elo-preview-team">
                        <div class="elo-preview-label">Team A Elo</div>
                        <div class="elo-preview-val" id="previewA">‚Äî</div>
                        <div class="elo-change-hint" id="previewADelta"></div>
                    </div>
                    <div class="elo-preview-sep">‚ö°</div>
                    <div class="elo-preview-team">
                        <div class="elo-preview-label">Team B Elo</div>
                        <div class="elo-preview-val" id="previewB">‚Äî</div>
                        <div class="elo-change-hint" id="previewBDelta"></div>
                    </div>
                </div>
                <button class="save-btn" id="saveBtn" onclick="saveMatch()">üíæ Save Result</button>
                <div class="save-success" id="saveSuccess"></div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HISTORY TAB ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="tab-content" id="tab-history">
        <div class="history-controls">
            <button class="btn-export" onclick="exportData()">‚¨á Export JSON</button>
        </div>
        <div class="stats-grid" id="statsGrid">
            <div class="no-history" style="grid-column:1/-1">Loading‚Ä¶</div>
        </div>
        <div class="date-filter-bar">
            <span class="date-filter-label">üóì Filter:</span>
            <input class="date-input" type="date" id="filterFrom" onchange="renderHistory()" />
            <span class="date-filter-sep">‚Üí</span>
            <input class="date-input" type="date" id="filterTo" onchange="renderHistory()" />
            <button class="btn-clear-filter" onclick="clearDateFilter()">‚úï Clear</button>
        </div>
        <div class="section-label">Match History</div>
        <div class="match-list" id="matchList">
            <div class="no-history">Loading‚Ä¶</div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ELO TAB ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="tab-content" id="tab-elo">
        <div class="elo-tab-content">
            <div class="elo-header">
                <div class="elo-header-title">‚ö° Elo Power Rankings</div>
                <div class="elo-header-desc">Starting Elo 1200 ¬∑ K-factor 32 ¬∑ Minimum 3 games for ranked status ¬∑ Click a player for full history</div>
            </div>
            <div class="elo-leaderboard" id="eloLeaderboard">
                <div class="no-history">Loading‚Ä¶</div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EDIT MATCH MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="editModal" style="display:none;" onclick="handleModalOverlayClick(event,'editModal')">
        <div class="modal">
            <div class="modal-title">‚úèÔ∏è Edit Match</div>
            <div class="modal-teams">
                <div>
                    <div class="modal-team-label team-a">‚ö° Team A</div>
                    <input class="modal-name-input" id="editA1" type="text" placeholder="Player 1" />
                    <input class="modal-name-input" id="editA2" type="text" placeholder="Player 2" />
                </div>
                <div class="modal-vs-col"><span class="modal-vs">VS</span></div>
                <div>
                    <div class="modal-team-label team-b">üåä Team B</div>
                    <input class="modal-name-input" id="editB1" type="text" placeholder="Player 1" />
                    <input class="modal-name-input" id="editB2" type="text" placeholder="Player 2" />
                </div>
            </div>
            <div class="modal-score-row">
                <div>
                    <div class="modal-score-label">SCORE A</div>
                    <input class="modal-score-input" type="number" id="editScoreA" min="0" max="99" placeholder="0" />
                </div>
                <div class="modal-vs">‚Äì</div>
                <div>
                    <div class="modal-score-label">SCORE B</div>
                    <input class="modal-score-input" type="number" id="editScoreB" min="0" max="99" placeholder="0" />
                </div>
            </div>
            <div class="modal-datetime-row">
                <div class="modal-datetime-label">üìÖ Date & Time</div>
                <input class="modal-datetime-input" type="datetime-local" id="editDateTime" />
            </div>
            <div class="modal-buttons">
                <button class="modal-btn-cancel" onclick="closeModal('editModal')">Cancel</button>
                <button class="modal-btn-save" id="editSaveBtn" onclick="saveEdit()">üíæ Save Changes</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLAYER STATS MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="playerModal" style="display:none;" onclick="handleModalOverlayClick(event,'playerModal')">
        <div class="player-modal">
            <div class="player-modal-header">
                <div class="player-modal-name-group">
                    <div class="player-modal-name" id="pmName">PLAYER</div>
                    <div class="player-modal-elo" id="pmEloDisplay">ELO ‚Äî</div>
                </div>
                <button class="modal-close-btn" onclick="closeModal('playerModal')">‚úï</button>
            </div>
            <div class="player-stats-grid" id="pmStatsGrid"></div>
            <div class="player-winrate-section">
                <div class="player-winrate-label">
                    <span>Win Rate</span>
                    <span id="pmWinratePct">0%</span>
                </div>
                <div class="player-winrate-bar">
                    <div class="player-winrate-fill" id="pmWinrateFill" style="width:0%"></div>
                </div>
            </div>
            <div class="player-elo-section">
                <div class="player-elo-section-title">
                    <span>Elo History</span>
                    <span id="pmEloPeak" style="font-size:0.7rem;letter-spacing:0.1em;color:var(--text-muted);font-family:'DM Sans',sans-serif;font-weight:400;"></span>
                </div>
                <div class="elo-spark" id="pmEloSpark"></div>
            </div>
            <div class="player-matches-title">Match History</div>
            <div id="pmMatchList"></div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCRIPTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- Load order matters: state first, then elo engine, then everything else -->
    <script src="js/state.js"></script>
    <script src="js/elo.js"></script>
    <script src="js/sync.js"></script>
    <script src="js/teams.js"></script>
    <script src="js/history.js"></script>
    <script src="js/elo-tab.js"></script>
    <script src="js/modals.js"></script>

    <script>
        // Entry point ‚Äî runs after all scripts are loaded
        loadFromServer();
    </script>

</body>
</html>
